@model IReadOnlyList<EventTickets.Models.Event>
@{ var categories = ViewBag.Categories as List<string> ?? new(); var qs = Context.Request.Query; }
<h1>Search Events</h1>
<form method="get">
  <input type="search" name="q" placeholder="Search by title..." value="@(qs["q"])" />
  <select name="category"><option value="">All Categories</option>@foreach (var c in categories){<option value="@c" selected="@(qs["category"]==c)">@c</option>}</select>
  <input type="date" name="start" value="@(qs["start"])" /> <input type="date" name="end" value="@(qs["end"])" />
  <select name="availability"><option value="">Any availability</option><option value="available" selected="@(qs["availability"]=="available")">Available</option><option value="soldout" selected="@(qs["availability"]=="soldout")">Sold out</option></select>
  <select name="sort"><option value="date" selected="@(qs["sort"]=="date")">Sort by Date</option><option value="title" selected="@(qs["sort"]=="title")">Sort by Title</option><option value="price" selected="@(qs["sort"]=="price")">Sort by Price</option></select>
  <button class="btn" type="submit">Search</button>
</form>
@if (Model.Count == 0){ <p class="muted">No results.</p> } else {
<table style="margin-top:1rem;"><thead><tr><th>Title</th><th>Category</th><th>Date</th><th>Price</th><th>Avail</th></tr></thead><tbody>
@foreach (var e in Model){<tr><td>@e.Title</td><td>@e.Category?.Name</td><td>@(e.DateTime?.ToString("yyyy-MM-dd HH:mm") ?? "-")</td><td>$@e.Price</td><td>@e.AvailableTickets</td></tr>}
</tbody></table>}
<p><a asp-controller="Home" asp-action="Index">‚Üê Back to Home</a></p>
